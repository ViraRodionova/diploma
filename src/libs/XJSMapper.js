module.exports=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e){function r(t){if(!t.xjs)throw"xjs is required";if(!t.mappings)throw"mappings are required";this.xjs=t.xjs,this.mappings=t.mappings,this._init()}t.exports=r,r.prototype={get:function(t){var e=this._getMappingByPath(t);return this._dereferenceMapping(e)},set:function(t){var e=this.flattern;for(var r in t){var n=t[r];r=this._normalizePath(r);var i=r.replace(/(\/\d+){2}$/,""),a=e[i];if(a||(i=r.replace(/(\/\d+){1}$/,""),a=e[i]),!a)throw"WRONG PATH "+r;var s=0,p=0,o=r.match(/\/(\d+)\/?(\d+)?$/);o&&(s=o[1]||0,p=o[2]||0);var f=this.xjs.addressParser.parse(a),h=o?{sheet:f.sheet,col:parseInt(f.startCol,10)+parseInt(p,10),row:parseInt(f.startRow,10)+parseInt(s,10)}:f;this.xjs._setCellValue(h,n)}},recompute:function(t){this.xjs.recompute(t)},_init:function(){this.flattern=this.flatternKeys(this.mappings)},_dereferenceMapping:function(t,e){var r=e||{};if("object"==typeof t){for(var n in t)r[n]=this._dereferenceMapping(t[n]);return r}var i=t;return this.xjs.getCellValue(i)},_getMappingByPath:function(t){if("/"==t)return this.mappings;for(var e=this._normalizePath(t),r=e.split(/\//),n=this.mappings,i=0;i<r.length;i++){var a=r[i];if(!n[a])throw"WRONG PATH "+e;n=n[a]}return n},_normalizePath:function(t){return t.replace(/\/$/,"").replace(/^\//,"")},flatternKeys:function(t,e,r){r||(r={});for(var n in t){var i=e?e+"/"+n:n,a=t[n];"object"==typeof a?this.flatternKeys(a,i,r):r[i]=a}return r}}}]);